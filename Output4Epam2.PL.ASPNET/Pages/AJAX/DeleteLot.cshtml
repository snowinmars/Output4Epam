@using Output4Epam.Entities
@using Output4Epam.Providers

@{
	bool isAdmin = LogicProvider.RegUserLogic.IsUserInRole(User.Identity.Name, RoleScroll.Admin.ToString());

	bool myLot = false;
	foreach (var item in LogicProvider.LotLogic.GetAll())
	{
		if (item.Owner == User.Identity.Name)
		{
			myLot = true;
		}
	}
}

@{
	if ((isAdmin) || (myLot))
	{
		if (IsPost)
		{
			try
			{

				Guid id = Guid.Parse(Request["Id"]);

				LogicProvider.LotLogic.Remove(id);
			}
			catch (NotImplementedException)
			{
				Response.Redirect("/Pages/ErrorPages/501.cshtml");
			}
			catch (ArgumentException)
			{
				Response.Redirect("/Pages/ErrorPages/400.cshtml");
			}
			catch
			{
				Response.Redirect("/Pages/ErrorPages/Other.cshtml");
			}
		}
	}
	Response.Redirect("/Pages/StructureElements/ShowMyLots.cshtml");
	return;
}
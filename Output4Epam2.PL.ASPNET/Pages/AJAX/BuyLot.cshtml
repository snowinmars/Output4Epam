@using Output4Epam.Entities
@using Output4Epam.Providers

@{
	bool isUser = LogicProvider.RegUserLogic.IsUserInRole(User.Identity.Name, RoleScroll.User.ToString());
}
@{
	if (isUser)
	{

		if (IsPost)
		{
			try
			{

				if (isUser)
				{
					Guid id = Guid.Parse(Request["Id"]);
					LogicProvider.LotLogic.Buy(id, User.Identity.Name);
					Response.Write(id.ToString());
				}
				else
				{
					Response.Redirect("/Pages/ErrorPage/403.cshtml");
				}
			}
			catch (NotImplementedException)
			{
				Response.Redirect("/Pages/ErrorPages/501.cshtml");
			}
			catch (ArgumentException)
			{
				Response.Redirect("/Pages/ErrorPages/400.cshtml");
			}
			catch
			{
				Response.Redirect("/Pages/ErrorPages/Other.cshtml");
			}
		}
	}
	Response.Redirect("/Pages/StructureElements/Index.cshtml");
	return;
}